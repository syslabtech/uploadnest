worker_processes 1;
events { worker_connections 1024; }
http {
    include       mime.types;
    default_type  application/octet-stream;
    sendfile        on;
    keepalive_timeout  65;
    server {
        listen       80;
        server_name  localhost;
        root   /usr/share/nginx/html;
        index  index.html;

        # Security headers to prevent site cloning and scraping
        add_header X-Frame-Options "DENY" always;
        add_header X-Content-Type-Options "nosniff" always;
        add_header X-XSS-Protection "1; mode=block" always;
        add_header Referrer-Policy "no-referrer" always;
        add_header Permissions-Policy "geolocation=(), microphone=(), camera=()" always;
        add_header Content-Security-Policy "default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self'; object-src 'none'; frame-ancestors 'none'; base-uri 'self';" always;
        add_header X-Robots-Tag "noindex, nofollow, nosnippet, noarchive, notranslate, noimageindex" always;

        # Block common scraping user agents (robust, readable)
        if ($http_user_agent ~* "(HTTrack|wget|curl|python-requests|libwww|scrapy|Go-http-client|okhttp|axios|aiohttp|httpclient|fetch|scan|nmap|masscan|sqlmap|dirbuster|dirb|wpscan|fimap|nikto|zmeu|havij|netsparker|sqlninja|acunetix|nessus|webinspect|AppScan|w3af|arachni|OpenVAS|Mozilla/5.0 \\(compatible;\\ Googlebot/|bingbot|Baiduspider|YandexBot|Sogou|Exabot|facebot|ia_archiver)") {
            return 403;
        }

        # Disable directory listing
        autoindex off;

        # Static file serving for images, videos, and software
        location ~* \.(?:jpg|jpeg|png|gif|ico|svg|webp|mp4|webm|ogg|mp3|zip|exe|msi|apk|dmg|tar|gz|rar|7z)$ {
            expires 30d;
            add_header Cache-Control "public, immutable";
            try_files $uri =404;
        }

        location / {
            try_files $uri $uri/ /index.html;
        }
    }
    # Set PID file to a writable location for non-root user
    pid /tmp/nginx.pid;
    # Set error and access logs to writable locations
    access_log /var/log/nginx/access.log;
    error_log /var/log/nginx/error.log;
}
